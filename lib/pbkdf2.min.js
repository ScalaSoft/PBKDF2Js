var crypto=require("crypto"),hexChar=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],saltString="",storedSubKeyString="",config={hashBytes:32,saltBytes:16,iterations:872791};module.exports={hashPassword:function(t,n){crypto.randomBytes(config.saltBytes,function(r,e){return r?n(r):void crypto.pbkdf2(t,e,config.iterations,config.hashBytes,function(t,r){if(t)return n(t);var i=new Buffer(r.length+e.length+8);i.writeUInt32BE(e.length,0,!0),i.writeUInt32BE(config.iterations,4,!0),e.copy(i,8),r.copy(i,e.length+8),n(null,i)})})},verifyPassword:function(t,n,r){var e=n.readUInt32BE(0),i=n.length-e-8,o=n.readUInt32BE(4),s=n.slice(8,e+8),a=n.toString("binary",e+8);crypto.pbkdf2(t,s,o,i,function(t,n){return t?r(t,!1):void r(null,n.toString("binary")===a)})}};